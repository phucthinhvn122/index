<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ƒê·ªïi Ti·ªÅn & Th·ªã Tr∆∞·ªùng</title>
    
    <link rel="apple-touch-icon" href="https://i.ibb.co/v4m8v7yX/exchange-logo.png?v=4">
    <link rel="icon" type="image/png" href="https://i.ibb.co/v4m8v7yX/exchange-logo.png?v=4">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ƒê·ªïi Ti·ªÅn">

    <style>
        :root {
            --primary: #007AFF;
            --bg: #000000;
            --card-bg: #1C1C1E;
            --text: #FFFFFF;
            --text-secondary: #8E8E93;
            --input-bg: #2C2C2E;
            --green: #30D158;
            --red: #FF453A;
            --nav-bg: rgba(28, 28, 30, 0.9);
            --focus-glow: rgba(0, 122, 255, 0.4);
        }

        @media (prefers-color-scheme: light) {
            :root {
                --bg: #F2F2F7;
                --card-bg: #FFFFFF;
                --text: #000000;
                --input-bg: #F2F2F7;
                --green: #34C759;
                --red: #FF3B30;
                --nav-bg: rgba(255, 255, 255, 0.9);
                --focus-glow: rgba(0, 122, 255, 0.2);
            }
        }

        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0;
            background-color: var(--bg);
            color: var(--text);
            overscroll-behavior-y: none;
            padding-bottom: calc(80px + env(safe-area-inset-bottom));
        }

        /* CHUY·ªÇN C·∫¢NH MOTION BLUR */
        .view-container { display: none; padding: 20px; }
        .view-container.active { 
            display: block; 
            animation: motionBlur 0.45s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; 
            will-change: transform, opacity, filter; 
        }
        @keyframes motionBlur { 
            0% { opacity: 0; transform: translateY(30px) scale(0.96); filter: blur(12px); } 
            100% { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); } 
        }

        /* GIAO DI·ªÜN CONVERTER */
        .converter-card { background: var(--card-bg); border-radius: 24px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); }
        
        /* HI·ªÜU ·ª®NG √î NH·∫¨P LI·ªÜU (FOCUS) */
        .input-group { 
            background: var(--input-bg); 
            border-radius: 16px; 
            padding: 16px; 
            margin-bottom: 4px; 
            border: 1px solid transparent;
            transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .input-group:focus-within {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px var(--focus-glow);
            border: 1px solid var(--primary);
        }
        
        .input-row { display: flex; align-items: center; justify-content: space-between; }
        input[type="number"], input[type="text"] { background: transparent; border: none; color: var(--text); font-size: 24px; font-weight: 700; width: 55%; outline: none; padding: 0; transition: color 0.2s; }
        input[type="number"]:focus { color: var(--primary); }

        .currency-pill { display: flex; align-items: center; gap: 8px; background: var(--card-bg); padding: 6px 12px; border-radius: 20px; position: relative; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .currency-pill img { width: 20px; height: 20px; border-radius: 50%; }
        select { position: absolute; right: 0; width: 100%; height: 100%; opacity: 0; }
        
        .swap-container { height: 0; display: flex; justify-content: center; align-items: center; z-index: 10; position: relative; }
        
        /* HI·ªÜU ·ª®NG N√öT ƒê·∫¢O CHI·ªÄU (XOAY L√í XO) */
        .swap-btn { 
            background: var(--primary); 
            color: white; 
            border: 4px solid var(--card-bg); 
            width: 44px; height: 44px; 
            border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            cursor: pointer; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
            /* cubic-bezier n√†y t·∫°o ƒë·ªô n·∫£y (bounce) khi xoay xong */
            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), background-color 0.2s; 
        }
        .swap-btn:active { background-color: #0056b3; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .swap-btn svg { width: 24px; height: 24px; }
        
        .result-box { margin-top: 24px; text-align: center; }
        .result-main { font-size: 32px; font-weight: 800; color: var(--primary); transition: opacity 0.2s; display: inline-block; }
        .rate-info { font-size: 13px; color: var(--text-secondary); margin-top: 8px; }

        /* HI·ªÜU ·ª®NG POP-UP KHI S·ªê THAY ƒê·ªîI */
        @keyframes popValue {
            0% { transform: scale(0.9); opacity: 0.7; color: #5AC8FA; }
            50% { transform: scale(1.08); color: var(--primary); }
            100% { transform: scale(1); opacity: 1; }
        }
        .pop-anim { animation: popValue 0.35s cubic-bezier(0.2, 0.8, 0.2, 1); }

        /* C√ÅC UI KH√ÅC GI·ªÆ NGUY√äN ... */
        .header-title { font-size: 28px; font-weight: 800; margin-bottom: 20px; margin-top: 20px; display: flex; align-items: center; gap: 10px; }
        .market-list { display: flex; flex-direction: column; gap: 12px; }
        .market-item { background: var(--card-bg); padding: 16px; border-radius: 16px; display: flex; justify-content: space-between; align-items: center; }
        .coin-info { display: flex; align-items: center; gap: 12px; }
        .coin-info img { width: 36px; height: 36px; border-radius: 50%; }
        .coin-name { font-weight: 600; font-size: 16px; }
        .coin-symbol { color: var(--text-secondary); font-size: 13px; text-transform: uppercase; }
        .price-info { text-align: right; }
        .price { font-weight: 700; font-size: 16px; }
        .change { font-size: 14px; font-weight: 600; margin-top: 2px; }
        .change.up { color: var(--green); }
        .change.down { color: var(--red); }

        .profile-header { text-align: center; padding: 20px 0 30px 0; position: relative; }
        .avatar { width: 85px; height: 85px; border-radius: 50%; background: linear-gradient(135deg, #007AFF, #5AC8FA); color: white; font-size: 30px; font-weight: bold; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px auto; box-shadow: 0 8px 20px rgba(0,122,255,0.25); border: 3px solid var(--card-bg); }
        .verified-badge { background: #34C759; color: white; font-size: 10px; padding: 4px 10px; border-radius: 10px; display: inline-block; margin-bottom: 8px; font-weight: 700; text-transform: uppercase; }
        .profile-name { font-size: 24px; font-weight: 800; margin: 0; }
        .profile-uid { color: var(--text-secondary); font-size: 12px; margin-top: 4px; }
        
        .settings-group { background: var(--card-bg); border-radius: 20px; overflow: hidden; margin-bottom: 20px; border: 0.5px solid rgba(128,128,128,0.1); }
        .setting-item { display: flex; justify-content: space-between; align-items: center; padding: 16px; border-bottom: 0.5px solid rgba(128,128,128,0.1); transition: 0.2s; }
        .setting-item:active { background: rgba(128,128,128,0.1); }
        .setting-item:last-child { border-bottom: none; }
        .setting-label { font-size: 15px; display: flex; align-items: center; gap: 14px; font-weight: 500; }
        .setting-icon { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .setting-value { color: var(--text-secondary); font-size: 14px; font-weight: 400; display: flex; align-items: center; gap: 4px; }

        .tab-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--nav-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); display: flex; justify-content: space-around; padding: 10px 0 calc(10px + env(safe-area-inset-bottom)); border-top: 0.5px solid rgba(128,128,128,0.2); z-index: 100; }
        .tab-item { display: flex; flex-direction: column; align-items: center; color: var(--text-secondary); font-size: 10px; gap: 4px; cursor: pointer; transition: 0.2s; width: 33%; }
        .tab-item.active { color: var(--primary); }
        .tab-item:active { transform: scale(0.9); }
        .tab-item svg { width: 24px; height: 24px; }
    </style>
</head>
<body>

<div id="view-home" class="view-container active">
    <div class="header-title">ƒê·ªïi Ti·ªÅn</div>
    <div class="converter-card">
        <div class="input-group">
            <label>S·ªë ti·ªÅn</label>
            <div class="input-row">
                <input type="number" id="amount" value="1" placeholder="0">
                <div class="currency-pill">
                    <img id="from-flag" src="https://flagcdn.com/w40/vn.png">
                    <span id="from-text">VND</span>
                    <select id="from-currency" onchange="updateUI('from')">
                        <option value="VND">VND</option>
                        <option value="USD">USDT</option>
                        <option value="BRL">BRL</option>
                        <option value="EUR">EUR</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="swap-container">
            <div class="swap-btn" id="btn-swap" onclick="swapCurrencies()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 16V4M7 4L3 8M7 4L11 8"></path><path d="M17 8v12M17 20l4-4M17 20l-4-4"></path></svg>
            </div>
        </div>
        <div class="input-group" style="margin-top: 4px;">
            <label>Chuy·ªÉn th√†nh</label>
            <div class="input-row">
                <input type="text" id="result-amount" disabled placeholder="0" readonly>
                <div class="currency-pill">
                    <img id="to-flag" src="https://cryptologos.cc/logos/tether-usdt-logo.png?v=026">
                    <span id="to-text">USDT</span>
                    <select id="to-currency" onchange="updateUI('to')">
                        <option value="USD" selected>USDT</option>
                        <option value="VND">VND</option>
                        <option value="BRL">BRL</option>
                        <option value="EUR">EUR</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="result-box">
            <div class="result-main" id="display-result">...</div>
            <div class="rate-info" id="rate-info">ƒêang t·∫£i...</div>
        </div>
    </div>
</div>

<div id="view-market" class="view-container">
    <div class="header-title">Th·ªã tr∆∞·ªùng 24h</div>
    <div class="market-list" id="market-data-container">
        <div style="text-align:center; color: #888; padding: 40px;">ƒêang t·∫£i d·ªØ li·ªáu th·ª±c...</div>
    </div>
</div>

<div id="view-profile" class="view-container">
    <div class="header-title">H·ªì s∆°</div>
    <div class="profile-header">
        <div class="verified-badge">‚úì ƒê√£ x√°c minh</div>
        <div class="avatar">PT</div>
        <h2 class="profile-name">Ph√∫c Th·ªãnh</h2>
        <p class="profile-uid">ID ng∆∞·ªùi d√πng: 002009-122</p>
    </div>
    <div class="settings-group">
        <div class="setting-item">
            <div class="setting-label"><div class="setting-icon" style="background: rgba(48, 209, 88, 0.1); color: #30D158;">üõ°Ô∏è</div>B·∫£o m·∫≠t t√†i kho·∫£n</div>
            <div class="setting-value">C·∫•p ƒë·ªô 3 ‚ùØ</div>
        </div>
        <div class="setting-item">
            <div class="setting-label"><div class="setting-icon" style="background: rgba(0, 122, 255, 0.1); color: #007AFF;">üí≥</div>Ph∆∞∆°ng th·ª©c thanh to√°n</div>
            <div class="setting-value">Vietcombank ‚ùØ</div>
        </div>
        <div class="setting-item">
            <div class="setting-label"><div class="setting-icon" style="background: rgba(255, 159, 10, 0.1); color: #FF9F0A;">üìä</div>H·∫°n m·ª©c giao d·ªãch</div>
            <div class="setting-value">Kh√¥ng gi·ªõi h·∫°n ‚ùØ</div>
        </div>
    </div>
    <div class="settings-group">
        <div class="setting-item">
            <div class="setting-label"><div class="setting-icon" style="background: rgba(175, 82, 222, 0.1); color: #AF52DE;">‚öôÔ∏è</div>C√†i ƒë·∫∑t ·ª©ng d·ª•ng</div>
            <div class="setting-value">v2.6 (Input Animations) ‚ùØ</div>
        </div>
        <div class="setting-item">
            <div class="setting-label"><div class="setting-icon" style="background: rgba(255, 69, 58, 0.1); color: #FF453A;">‚úâÔ∏è</div>Trung t√¢m h·ªó tr·ª£</div>
            <div class="setting-value">Tr·ª±c tuy·∫øn ‚ùØ</div>
        </div>
    </div>
</div>

<div class="tab-bar">
    <div class="tab-item active" onclick="switchTab('home', this)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
        <span>ƒê·ªïi ti·ªÅn</span>
    </div>
    <div class="tab-item" onclick="switchTab('market', this)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
        <span>Th·ªã tr∆∞·ªùng</span>
    </div>
    <div class="tab-item" onclick="switchTab('profile', this)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
        <span>H·ªì s∆°</span>
    </div>
</div>

<script>
    function switchTab(tabId, element) {
        document.querySelectorAll('.view-container').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-item').forEach(el => el.classList.remove('active'));
        setTimeout(() => { document.getElementById('view-' + tabId).classList.add('active'); }, 10);
        element.classList.add('active');
        if (tabId === 'market' && !marketLoaded) fetchMarketData();
    }

    let marketLoaded = false;
    async function fetchMarketData() {
        const container = document.getElementById('market-data-container');
        try {
            const resCrypto = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=vnd&ids=bitcoin,ethereum,tether,binancecoin,solana&order=market_cap_desc');
            const cryptoData = await resCrypto.json();
            const resFiat = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
            const fiatData = await resFiat.json();

            let html = '';
            const fiatList = [
                { id: 'usd', name: 'ƒê√¥ la M·ªπ', symbol: 'USD', img: 'https://flagcdn.com/w40/us.png', price: fiatData.rates['VND'], change: 0.15 },
                { id: 'eur', name: 'Euro', symbol: 'EUR', img: 'https://flagcdn.com/w40/eu.png', price: fiatData.rates['VND'] / fiatData.rates['EUR'], change: -0.12 },
                { id: 'brl', name: 'Brazil Real', symbol: 'BRL', img: 'https://flagcdn.com/w40/br.png', price: fiatData.rates['VND'] / fiatData.rates['BRL'], change: 0.45 }
            ];
            
            fiatList.forEach(c => {
                const color = c.change >= 0 ? 'up' : 'down';
                const sign = c.change >= 0 ? '+' : '';
                html += `<div class="market-item"><div class="coin-info"><img src="${c.img}"><div><div class="coin-name">${c.symbol}</div><div class="coin-symbol">${c.name}</div></div></div><div class="price-info"><div class="price">${c.price.toLocaleString('vi-VN', {maximumFractionDigits:0})} ‚Ç´</div><div class="change ${color}">${sign}${c.change}%</div></div></div>`;
            });

            cryptoData.forEach(c => {
                const chg = c.price_change_percentage_24h;
                const color = chg >= 0 ? 'up' : 'down';
                const sign = chg >= 0 ? '+' : '';
                html += `<div class="market-item"><div class="coin-info"><img src="${c.image}"><div><div class="coin-name">${c.symbol.toUpperCase()}</div><div class="coin-symbol">${c.name}</div></div></div><div class="price-info"><div class="price">${c.current_price.toLocaleString('vi-VN')} ‚Ç´</div><div class="change ${color}">${sign}${chg.toFixed(2)}%</div></div></div>`;
            });
            container.innerHTML = html;
            marketLoaded = true;
        } catch (e) { container.innerHTML = '<div style="text-align:center;margin-top:20px;">L·ªói t·∫£i d·ªØ li·ªáu</div>'; }
    }

    const meta = {
        'VND': { flag: 'https://flagcdn.com/w40/vn.png', text: 'VND' },
        'USD': { flag: 'https://cryptologos.cc/logos/tether-usdt-logo.png?v=026', text: 'USDT' },
        'BRL': { flag: 'https://flagcdn.com/w40/br.png', text: 'BRL' },
        'EUR': { flag: 'https://flagcdn.com/w40/eu.png', text: 'EUR' }
    };

    function updateUI(type) {
        const code = document.getElementById(type + '-currency').value;
        if(meta[code]) {
            document.getElementById(type + '-flag').src = meta[code].flag;
            document.getElementById(type + '-text').innerText = meta[code].text;
        }
        calculate();
    }

    async function calculate() {
        const amount = parseFloat(document.getElementById('amount').value);
        const from = document.getElementById('from-currency').value;
        const to = document.getElementById('to-currency').value;
        const dRes = document.getElementById('display-result');

        if (isNaN(amount)) { dRes.innerText = "0"; document.getElementById('result-amount').value = ""; return; }
        dRes.style.opacity = '0.5';

        try {
            let rate = 1;
            if(from !== to) {
                const req = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await req.json();
                rate = (1 / data.rates[from]) * data.rates[to];
            }
            updateDisplay(amount, amount * rate, rate, from, to);
        } catch(e) { document.getElementById('rate-info').innerText = "L·ªói m·∫°ng"; }
    }

    function updateDisplay(amt, total, rate, from, to) {
        const resInput = document.getElementById('result-amount');
        const dRes = document.getElementById('display-result');
        const rInfo = document.getElementById('rate-info');
        
        let prec = total < 1 ? 6 : (total < 1000 ? 4 : 2);
        if(total > 0 && total < 0.0001) prec = 8;

        const fmtTot = total.toLocaleString('vi-VN', { maximumFractionDigits: prec, minimumFractionDigits: 0 });
        resInput.value = fmtTot;
        dRes.innerText = `${fmtTot} ${meta[to].text}`;
        
        // Trigger Pop Animation
        dRes.classList.remove('pop-anim');
        void dRes.offsetWidth; // reset CSS animation
        dRes.classList.add('pop-anim');
        dRes.style.opacity = '1';

        if (rate < 1 && rate > 0) {
            rInfo.innerText = `1 ${meta[to].text} ‚âà ${(1/rate).toLocaleString('vi-VN', {maximumFractionDigits:2})} ${meta[from].text}`;
        } else {
            rInfo.innerText = `1 ${meta[from].text} ‚âà ${rate.toLocaleString('vi-VN', {maximumFractionDigits:4})} ${meta[to].text}`;
        }
    }

    // Bi·∫øn l∆∞u tr·ªØ g√≥c xoay c·ªßa m≈©i t√™n
    let rotationDegree = 0;

    function swapCurrencies() {
        // Xoay m≈©i t√™n th√™m 180 ƒë·ªô
        rotationDegree += 180;
        document.getElementById('btn-swap').style.transform = `rotate(${rotationDegree}deg)`;

        // ƒê·∫£o ng∆∞·ª£c gi√° tr·ªã
        const f = document.getElementById('from-currency');
        const t = document.getElementById('to-currency');
        [f.value, t.value] = [t.value, f.value];
        updateUI('from'); updateUI('to');
    }

    document.getElementById('amount').addEventListener('input', () => { clearTimeout(window.t); window.t = setTimeout(calculate, 500); });
    updateUI('from');
</script>

</body>
</html>
</html>
